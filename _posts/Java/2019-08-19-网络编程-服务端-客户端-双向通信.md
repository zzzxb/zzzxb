---
layout: post
title:  "ç½‘ç»œç¼–ç¨‹-æœåŠ¡ç«¯-å®¢æˆ·ç«¯-åŒå‘é€šä¿¡"
date:   2019-08-19 22:21:48 +0800
categories: Java
tag: Java
---

* content
{:toc}

* ps å›¾ç‰‡ä¸­ç±»ä¸æ–¹æ³•çš„è¿æ¥ä¸å¯¹ï¼ŒçŸ¥é“æ–¹æ³•å¦‚ä½•é˜»å¡çš„å°±è¡Œäº†ğŸ˜µ.

ä»Šå¤©å†å†™ç½‘ç»œé€šä¿¡çš„æ—¶å€™é‡åˆ°äº†æˆ‘ä¸€ç›´æ²¡æƒ³æ˜ç™½çš„é—®é¢˜ï¼Œç‰¹ç®€å•çš„å°±æ˜¯æˆ‘æ²¡å¼„æ¸…æ¥šæµç¨‹å’Œæ–¹æ³•çš„ä½¿ç”¨ğŸ˜ï¼ŒçœŸçš„å¥½å°´å°¬.

![communication1]({{'/styles/images/communication1.png' | propend: site.baseurl }})
ç”±äºåœ¨æ¥æ”¶ä¿¡æ¯çš„æ—¶å€™`readline()`,`readUTF`éƒ½ä¼šè®©çº¿ç¨‹é˜»å¡åœ¨è¿™é‡Œï¼Œä¸€ç›´ç­‰å¾…æ¥æ”¶ä¿¡æ¯,ç›´åˆ°æ¥æ”¶ä¹‹åæ‰æ¥ç€å¾€ä¸‹è¿è¡Œ,æ‰€ä»¥**Client** ä¸ **Servers** çš„ æ¥æ”¶ å’Œ å‘é€ éœ€è¦é¢ å€’ä¸€ä¸‹,éœ€è¦å…ˆå‘é€ä¿¡æ¯çš„å°±æŠŠ å‘é€æ”¾å‰è¾¹ï¼Œæ¥æ”¶ç½®åï¼Œ åä¹‹.

å‡å¦‚éœ€è¦å®¢æˆ·ç«¯å…ˆå‘é€ä¿¡æ¯,ç„¶åæœåŠ¡ç«¯è¿›è¡Œè½¬å‘ï¼Œå°±éœ€è¦å»ºç«‹å¦‚ä¸‹å›¾æ‰€ç¤ºçš„è”ç³»:

![communication1]({{'/styles/images/communication2.png' | propend: site.baseurl }})

åªæœ‰è¿™æ ·å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„çº¿ç¨‹æ‰ä¸ä¼šåŒæ—¶æ­»é”,ä¸è¿‡å•çº¿ç¨‹ä¹Ÿæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¸èƒ½ä¸€è¾¹æ¥æ”¶ä¸€è¾¹å‘é€ï¼Œå¦‚æœåˆ†åˆ«ç»™æ¥æ”¶å’Œå‘é€å»ºç«‹ä¸€ä¸ªç‹¬äº«çº¿ç¨‹ï¼Œè¿™æ ·åº”è¯¥èƒ½ä¸€è¾¹å‘é€ä¸€è¾¹æ¥æ”¶å¼‚æ­¥è¿›è¡Œäº†.

æŠ€æœ¯ä¸å¥½ï¼ŒçŒ®ä¸‘äº†,åªå¬è€å¸ˆè®²ä¹Ÿä¸è¡Œï¼Œè¿˜å¾—è‡ªå·±å»ä¸Šæ‰‹æ‰èƒ½ä»ä¸­å‘ç°é—®é¢˜.

å…ˆé™„ä¸ŠæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯çš„åŒå‘é€šä¿¡ï¼Œæ™šç‚¹å†å†™ä¸€ä¸ªå¤šäººèŠå¤©çš„ç¨‹åºç»ƒä¸‹æ‰‹

* **Client**

```java
/**
 * @author Zzzxb  2019/8/19 19:01
 * @description:
 */
public class Client {
    private Socket socket;
    private BufferedReader in;
    private DataInputStream input;
    private DataOutputStream output;

    public Client(String address, int port) {
        try {
            socket = new Socket(address, port);
            init();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void init() throws Exception {
        System.out.println("Connection successful");
        in = new BufferedReader(new InputStreamReader(System.in));
        input = new DataInputStream(socket.getInputStream());
        output = new DataOutputStream(socket.getOutputStream());
        try {
            while (true) {
                // å‘é€æ¶ˆæ¯
                String content = in.readLine();
                output.writeUTF(content);
                output.flush();
                // æ¥æ”¶æ¶ˆæ¯
                String message = input.readUTF();
                System.out.println(message);
            }
        } finally {
            input.close();
            output.close();
            in.close();
            socket.close();
        }
    }

    public static void main(String[] args) {
        Client client = new Client("127.0.0.1", 6001);
    }
}
```

* **Servers**

```java
/**
 * @author Zzzxb  2019/8/19 19:01
 * @description:
 */
public class Servers {
    private ServerSocket serverSocket;
    private DataInputStream input;
    private DataOutputStream output;

    public Servers(int port) {
        try {
            serverSocket = new ServerSocket(port);
            System.out.println("--- Start server ---");
            System.out.println("--- wait connection ---");
            init(serverSocket.accept());
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void init(Socket socket) throws Exception {
        System.out.println(socket.getInetAddress().getHostAddress() +
                "\tconnection");
        input = new DataInputStream(socket.getInputStream());
        output = new DataOutputStream(socket.getOutputStream());
        try {
            while (true) {
                // æ¥æ”¶æ¶ˆæ¯
                String content = input.readUTF();
                System.out.println(content);
                //å‘é€æ¶ˆæ¯
                output.writeUTF(content);
                output.flush();
            }
        } catch (Exception e) {
            System.err.println("å¼‚å¸¸é€€å‡º");
        } finally {
            output.close();
            input.close();
            socket.close();
        }
    }

    public static void main(String[] args) {
        Servers servers = new Servers(6001);
    }
}
```
